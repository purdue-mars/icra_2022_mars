<launch>
    <arg name="ips" default="{pan_pan/robot_ip: 172.16.1.2, an_an/robot_ip: 172.18.1.2}"/>
    <arg name="robot_id" default="combined_arms" />
    <rosparam file="$(find mars_config)/config/planning_dual_arm.yml" command="load" subst_value="true" />

    <group ns="$(arg robot_id)">
        <include file="$(find dual_mars_arm_moveit_config)/launch/move_group.launch"/>
        <node pkg="rviz" type="rviz" name="rviz" args="-d $(find mars_launch)/rviz/dual_config.rviz" />
        <node pkg="mars_control" name="panda_planning_server" type="planning_server" output="screen">
            <param name="combined_planning_group" value="$(arg robot_id)" />
        </node>
        <rosparam command="load" file="$(find icra18)/config/controllers.yaml" /> 

        <include ns="pan_pan" file="$(find wsg_50_driver)/launch/wsg_50_ip.launch">
            <arg name="ip" default="192.168.0.150" />
            <arg name="port" default="1001" />
            <arg name="com_mode" default="script" />
            <arg name="home_at_start" default="false" />
            <arg name="force" default="35" />
        </include>
        <include ns="an_an" file="$(find wsg_50_driver)/launch/wsg_50_ip.launch">
            <arg name="ip" default="172.19.1.2" />
            <arg name="port" default="1000" />
            <arg name="com_mode" default="script" />
            <arg name="home_at_start" default="false" />
            <arg name="force" default="35" />
        </include>
    </group>

    <include file="$(find franka_control)/launch/mars_combined_control.launch">
        <arg name="robot_ips" value="$(arg ips)"/>
        <arg name="robot_id" value="$(arg robot_id)" />
    </include>

    <group ns="perception">
        <include file="$(find mars_launch)/launch/gelsight.launch" >
            <arg name="robot_id" value="an_an"/>
            <arg name="config_file" value="gelsight_an_an.yml"/>
            <arg name="gripper_pose" value="0 0 0.16 0 0 0 an_an_link8 an_an_gelsight_pad"/>
        </include>
        <include file="$(find mars_launch)/launch/gelsight.launch" >
            <arg name="robot_id" value="pan_pan"/>
            <arg name="config_file" value="gelsight_pan_pan.yml"/>
        </include>
        <include file="$(find mars_launch)/launch/perception.launch">
            <arg name="robot_id" value="pan_pan" />
        </include>
    </group>
</launch>